<!DOCTYPE html>
<html>
<head>
    <title>TAIC Document Searcher</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.png">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.33.0.min.js" charset="utf-8"></script>
    
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.js"></script>
    
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.css" />

    <!-- Custom Stylesheets-->
    <link rel="stylesheet" type="text/css" href="/static/css/main.css">

    <!-- Custom JavaScript-->
    <script type="text/javascript" src="/static/js/main.js"></script>
</head>
<body>
    <div id="webappinfo">
        <div id="titleBlock">
            <h1>TAIC Document Searcher</h1>
            <h5>Version 1.0 beta</h5>
        </div>
        <div id="sesstionInfo">
            <p>Data last updated: 2024-07-01</p>
        </div>
    </div>
    <form method="post" id="searchForm" action="/search">
        <p id="searchErrorMessage" style="display: none;"></p>
        <div class="row">
            <input type="search" size="30" id="searchQuery" name="searchQuery" placeholder="Enter search query" autocomplete="on" autofocus>  
            <button type="button" id="advancedSearchBtn">Search settings</button>
            <button type="reset" id="resetBtn">Reset</button>    
            <input type="submit" value="Search">
        </div>
        <div id="advancedSearch">
            <div class="row">
                <div id="transportModes" class="advancedSearchSection">
                    <h5>Transport Modes</h5>
                    <div class="checkbox-group required">
                        <label><input type="checkbox" name="includeModeAviation" checked>Aviation</label>
                        <label><input type="checkbox" name="includeModeRail" checked>Rail</label>
                        <label><input type="checkbox" name="includeModeMarine" checked>Marine</label>
                    </div>
                </div>
                <div id="reportYearRange" class="advancedSearchSection">
                    <h5>Report year range</h5>
                    <div id="yearSlider"></div>
                </div>
            </div>
            <div class="row">
                <div id="relevanceCutoff" class="advancedSearchSection">
                    <h5>Relevance cutoff</h5>
                    <div class="relevanceCutoffSliderWrapper">
                        <label for="relevanceCutoffSlider" id="relevanceCutoffSliderLabel">0.6</label><br>
                        <input type="range" name="relevanceCutoff" min="0" max="1" value="0.6" class="slider" step ="0.01" id="relevanceCutoffSlider">
                    </div>
                </div>
                <div id="documentTyes" class="advancedSearchSection">
                    <h5>Document Types</h5>
                    <div class="checkbox-group required">
                        <label><input type="checkbox" name="includeSafetyIssues" checked>Safety issues</label>
                        <label><input type="checkbox" name="includeRecommendations" checked>Recommendations</label>
                        <label><input type="checkbox" name="includeReportSection" checked>Report sections</label>
                        <label><input type="checkbox" name="includeImportantText" checked>Entire report</label>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <br>
    <br>
    <!-- Loading sign with spinning animation -->
    <div id="loading"><br><br>Loading...</div>

    <!-- Placeholder for displaying search results -->
    <div id="searchResults" style="display: none;">
        <h2>Search Results</h2>
        <div id="resultButtons" class="resultsSection">
            <button type="button" id="downloadCSVBtn_results" >Download CSV</button>
        </div>
        <div id="searchResultsSummary" class="resultsSection">
            <h3>Summary of Search (AI generated)</h3>
            <div id="searchResultsSummaryText"></div>
        </div>
        <div class="resultsSection">
            <button type="button" id="toggleResultsSummaryInfo">Toggle summary info</button>
            <div id="searchResultsSummaryInfo">
                <h4>Results information</h4>
                <div id="resultsSummaryText"></div>
                <div id="resultsSummaryVisuals">
                    <div id="MostCommmonDocumentTypes" class="resultsSummaryInfoSection"></div>
                    <div id="MostCommonEventTypes" class="resultsSummaryInfoSection"></div>
                    <div id="YearHistogram" class="resultsSummaryInfoSection"></div>
                    <div id="ModePieChart"class="resultsSummaryInfoSection"></div>
                </div>
                </div>
            <h3>Relevant safety issues</h3>
            <div id="searchResultsTableWrapper"></div>
        </div>
    </div>

    <div id="modalContainer">
        <div id="modalContent">
            <div id="modalHeader">
                <h3 id="modalTitle"></h3>
                <span class="close" id="closeModal">&times;</span>
            </div>
            <div id="modalText" class="scrollable-content">
            </div>
        </div>
    </div>
    <footer>
        <p>Created by <a href="https://github.com/1jamesthompson1">James Thompson</a> for the <a href="https://www.taic.org.nz">New Zealand Transport Accident Investigation Commission.</a></p>
        <p>Contact directed to <a href="mailto:james.thompson@taic.org.nz">james.thompson@taic.org.nz</a>, project is being developed openly on <a href="https://github.com/1jamesthompson1/TAIC-report-summary">https://github.com/1jamesthompson1/TAIC-report-summary</a></p>
    </footer>
</body>
</html>
